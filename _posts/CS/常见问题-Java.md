---
title: 常见问题-Java
date: 2018-05-26 09:54:02
categories: java
tags: [java, Q&A]
---
[toc]
# 锁

## 如何检测死锁
死锁一旦出现，业务是可感知的，因为无法继续提供服务，这时候通过将线程信息dump出（通过jstack 或 vmvisual等工具），可以查看哪个线程出现了类似“Blocked”信息，即有可能该线程出现了死锁。

## 避免死锁的常用方法
* 避免一个线程同时获得多个锁；
* 避免一个线程在锁内同时占用多个资源，尽量保证每个锁只占用一个资源；
* 尝试使用定时锁，使用 lock.tryLock(timeout)来代替使用内部锁机制；
* 对于数据库锁，加锁和解锁必须在同一个数据库连接里，否则会出现解锁失败的情况。
etc.

## 乐观锁 vs 悲观锁
