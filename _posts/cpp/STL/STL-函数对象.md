---
title: STL-函数对象
date: 2018-05-19 13:54:45
categories: cpp
tags: cpp
---
[toc]
## 仿函数/函数对象
**将“function call 操作符，即‘()’，重载了的一种类”**。
在 STL 早期历史中被称为仿函数（functors），C++ 标准后采用的名称是函数对象（function objects）：一种具有函数特性的对象。
它在 STL 中扮演“策略”的角色，使得 STL 算法具有灵活的变化，其关键就在于 **函数对象的可适配性（adaptability）**。

## 用途
STL 所提供的算法一般有两个版本：一个表现为最常用/最直观的某种运算，另一个版本则表现最泛化的演算流程，允许用户“以 template 参数来指定所要采取的策略”。而函数对象的主要作用，也就是以参数形式作为算法的这种策略。
之所以函数对象能够作为参数，是因为，当作为调用者时，它可以像函数一样使用（调用/被调用）；而作为被调用者时，它能够以对象所定义的 function call operator 扮演函数的实质角色，简单理解就是，**一个“行为类似函数”的对象**，或，使一个类的使用看上去像是一个函数。

## 举例
以STL sort()函数为例。第一个版本就是直观上的非递减排序，以 operator< 为排序时的元素位置调整依据；而第二个版本允许用户指定任何“操作”，务求排序后的两两相邻元素都能令该操作为真，即，把某种“操作”作为算法的参数。而实现方式就是：
* 先将该“操作”（可能有数条指令）设计为一个函数，再将函数指针当作算法的一个参数；
* 将该“操作”设计为一个所谓的仿函数（语言层面而言，就是个 class），再以该仿函数产生一个对象，并以此对象作为算法的一个参数。

上述表明了函数指针可以实现“将整组操作当作算法的参数”，但依然引入函数对象的原因是，函数指针不能满足 STL 对抽象性的要求，而且函数指针也不能和 STL 其他组件如适配器等搭配使用，从而产生更灵活的变化。

## 分类
*STL 内建的函数对象包含在 <functional\> 头文件里。SGI 定义在<stl_function.h\>里。*
以 **操作数（operand）的个数** 划分，可以分为:
* 一元函数对象；
* 二元函数对象；

以 **功能划分**，可分为：
* 算术运算（Arithmetic）：
> 加法：plus<T\>;
> 减法：minus<T\>;
> 乘法：multiplies<T\>;
> 除法：divides<T\>;
> 取模：modulus<T\>;
> 否定：negate<T\>;（一元）

* 关系运算（Rational）：
> 等于：equal_to<T\>;
> 不等于：not_equal_to<T\>;
> 大于：greater<T\>;
> 大于或等于：greater_equal<T\>;
> 小于：less<T\>;
> 小于或等于：less_equal<T\>;

* 逻辑运算（Logical）:
> And：logical_and<T\>;
> Or：logical_or<T\>;
> Not：logical_not<T\>;(一元)


