---
title: 存储设备
date: 2018-04-12 15:02:33
categories: CS
tags: CS
---
_这里的 CS 指 Computer System。硬件结构相关的扫盲贴。_

计算机的5大组成部分为：输入、输出、存储器、数据通路（运算器）、控制器。
后两者合称处理器，即简单来说，计算机组成主要包括：I/O 设备，存储设备，CPU。
{% asset_img 5个部件.PNG 组成计算机的5个部件 %}

这篇主要关于存储设备。

局部性原理（比如在图书馆查阅某一类书籍）表明了在任何时间内，程序访问的只是地址空间相对较小的一部分内容：
**时间局部性（temporal locality）**：如果某个数据项被访问，那么在不久的将来它可能再次被访问；
**空间局部性（spatial locality）**：如果某个数据项被访问，与它地址向邻的数据项可能很快也将被访问。

局部性原理适用于存储器的层次结构。
存储器层次结构：一种由多存储器层次组成的结构，存储器的容量和访问时间随着离处理器的距离增加而增加。

**存储器技术**
目前用于构建存储器层次结构的主要有四中技术：
* **SRAM（静态随机存取存储器）**，作为靠近处理器的那层 cache。一种组织成存储阵列结构的简单集成电路，不需要刷新，对任何数据的访问时间都是固定的，并且与周期时间非常接近，只要给它加电，其中的数据就能保持，属于易失去性存储。当今处理器芯片中集成了多层次的 cache（如PC的三级缓存），独立的SRAM几乎没有了。
* **DRAM（动态随机存取存储器）**，作为主存储器。存储单元使用电容保存电荷的方式来存储数据，因此不能长久地保存数据，必须周期性地刷新，这就是：”动态“的由来（相比于SRAM的不需要刷新）。为了进一步优化与处理器的接口，DRAM增加了时钟，因此称之为同步DRAM（SDRAM）。其优势在于使用时钟对存储器和处理器保持同步。其速度上的优势主要源于不需要额外指定地址位，在时钟的控制下以突发方式传送连续数据的能力。最快的版本称为 **双数据速率（DDR）**  SDRAM。该名称表示在时钟的上升沿和下降沿都传递数据，因此获得双倍的数据带宽。该技术最新版本为 DDR4，一个 DDR4-3200 DRAM 每秒可以传输3200兆次，即其时钟频率为1600MHz。
* **闪存（flash）**，这种非易失存储器主要用于个人移动设备中的非易失二级存储器。一种 **电可擦除的可编程只读存取器（EEPROM）**。对闪存的写操作会使存储位损耗，因此大多使用控制器用来将写操作从已经写入很多次的块中映射到写入次数较少的块中，从而尽量分散写操作，即损耗均衡（wear leveling）。这种均衡技术也将制造过程中出错的存储单元屏蔽掉，从而提高成品率。
* **磁盘（disk）**，通常是服务器中容量最大且速度最慢的一层。
_**磁盘简介**_：
一个磁质硬盘包含一组圆形磁盘片，它们绕着轴心每分钟转动 5 400 - 15 000 周。每个磁盘片的表明划分为同心圆环，称为 **磁道（track）**。 每个面通常由几万条磁道，即几万个磁道，每条磁道同样被划分为用于存储信息的 **扇区（sector）**，每条磁道有几千个扇区，每个扇区的容量通常是 512 - 4096 字节。扇区是磁道的基本单位，是磁盘上信息数据读写的最小单位。信息的保存顺序为扇区号、一个间隙、包含该扇区纠错码的信息、一个间隙、下一个扇区号。 每层磁盘片的表面有一个包含小的电磁线圈的 **读写磁头**，访问每个盘面的磁头连在一起相互协调运动，因此磁头全部位于相同的扇区。术语 **柱面** 用来表示磁头在给定点时访问到所有盘面上的所有扇区的集合。
　　为了访问数据，OS 必须对磁盘进行三步操作：
> * **寻道时间**：将磁头移动到适当的磁道上，称为 **寻道（seek）**，所需时间即为寻道时间。厂商测量的平均寻道时间通常在 3 - 13 ms，但由于应用程序及磁盘访问调度策略的不同，且磁盘数据具有局部性，实际平均寻道时间通常只有标称数据的 25% - 33%。
> * **旋转延时（rotational latency）**：一旦磁头到达了正确磁道，就必须等待要访问的扇区转动到读写头下面，该等待时间即为旋转延时。平均延时通常是磁盘转动一周时间的一半。5 400 周的磁盘平均旋转延时为：
![](http://chart.googleapis.com/chart?cht=tx&chl=Average Rotational Latency=\frac{0.5  rotation}{5400 RPM}=5.6 ms)
> * **传输时间**：即传输一块数据需要的时间。该时间是扇区大小、旋转速度和磁道信息密度的一个函数。

_磁盘和半导体存储技术的主要差别是前者访问速度慢，因为它们是机械器件——闪存比磁盘快3个数量级，DRAM 比磁盘快5个数量级。与闪存类似，磁盘是非易失的，但却不存在写损耗问题。然而，闪存更加坚固，因此更适合于个人移动设备。_

_其他类型的存储介质_
**SSD(Solid State Drives, 固态硬盘)** 用固态电子存储芯片阵列组成的硬盘，由控制单元和存储单元（flash 或 DRAM）组成。固盘在接口的规范和定义、功能及使用方法上与普通的磁盘相同，产品外形尺寸上也一致。固盘（的存储单元）使用闪存颗粒制作，读写速度快，内部不存在任何机械部件，防震抗摔；存在闪存擦写次数限制问题，所以寿命短，并且容量不大（目前最大为 4TB）。普遍采用 SATA-2、SATA-3、mSATA、PCIe、M.2等规格接口。
使用建议：不要使用碎片整理、小分区&少分区、保留足够剩余空间、及时刷新固件、使用恢复指令（Trim）等。
